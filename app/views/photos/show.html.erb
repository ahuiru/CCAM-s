
<div class="columns  is-centered">
  <div class="column is-7">
    <div class="card mb-6">
      <div class="card-image">
        <figure class="image">
          <%= link_to [@photo] do %>
            <%= image_tag @photo.image %>
          <% end %>
        </figure>
      </div>
      <div class="card-content pt-4">
        <div class="like-button mr-3 pt-1" id="like-button-<%= @photo.id %>">
          <% if current_user.likes.exists?(photo_id: @photo.id) %>
            <%= render 'likes/unlike_button', photo: @photo %>
          <% else %>
            <%= render 'likes/like_button', photo: @photo %>
          <% end %>
        </div>
        <div class="has-text-weight-semibold is-size-5">
          <%= link_to @photo.user.email, [@photo.user] %>
        </div>
        <div class="pt-1 pl-2">
          <p><%= @photo.caption %></p>
        </div>
        <div class="pt-1 pl-2">
          <p>漫画:<%= @photo.comic %></p>
        </div>
        <div class="photo-deltete-button has-text-right">
          <% if @photo.user == current_user %>
            <%= link_to [@photo], method: :delete do %>
              <i class="fa fa-trash" aria-hidden="true"></i>
            <% end %>
            <%= link_to edit_photo_path(@photo) do %>
              <i class="fas fa-edit"></i>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>



    <% @photo.comments.each do |comment| %>
      <div class="card mb-1 comment">
        <div class="card-image">
          <div class="card-content pb-3">
            <div class="image">
              <% if comment.user.image.attached? %>
                <%= image_tag comment.user.image, class: 'image is-32x32 is-rounded'%>
              <% else %>
                <%= image_tag 'default.jpeg', class: "image is-32x32 is-rounded" %>
              <% end %>
            </div>
            <div class="comment-name mt-1">
              <%= link_to comment.user.name, [comment.user], class: 'ml-2' %>
            </div>
            <div class="pt-5 pl-2">
              <%= comment.body %>
            </div>
            <% if comment.user == current_user %>
              <div class="pl-2 has-text-right">
                <%= link_to 'delete', [@photo, comment] , method: :delete %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>


    <% if user_signed_in? %>

      <div class="card mb-1 mt-5">
        <div class="card-image">
          <div class="card-content">
            <% if @comment.errors.any? %>
              <% @comment.errors.full_messages.each do |message| %>
                <div><%= message %></div>
              <% end %>
            <% end %>
            <%= form_with model: [@photo, @comment], local:true do |f| %>
              <div class="field">
                <%= f.text_field :body, class: 'input' %>
              </div>
              <%= f.submit class: 'button is-primary' %>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
